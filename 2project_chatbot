{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"kK_F9VWPTxc6"},"outputs":[{"name":"stdout","output_type":"stream","text":["Requirement already satisfied: nltk in /usr/local/lib/python3.12/dist-packages (3.9.1)\n","Requirement already satisfied: spacy in /usr/local/lib/python3.12/dist-packages (3.8.7)\n","Requirement already satisfied: click in /usr/local/lib/python3.12/dist-packages (from nltk) (8.3.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.12/dist-packages (from nltk) (1.5.2)\n","Requirement already satisfied: regex\u003e=2021.8.3 in /usr/local/lib/python3.12/dist-packages (from nltk) (2024.11.6)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from nltk) (4.67.1)\n","Requirement already satisfied: spacy-legacy\u003c3.1.0,\u003e=3.0.11 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.0.12)\n","Requirement already satisfied: spacy-loggers\u003c2.0.0,\u003e=1.0.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (1.0.5)\n","Requirement already satisfied: murmurhash\u003c1.1.0,\u003e=0.28.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (1.0.13)\n","Requirement already satisfied: cymem\u003c2.1.0,\u003e=2.0.2 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.0.11)\n","Requirement already satisfied: preshed\u003c3.1.0,\u003e=3.0.2 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.0.10)\n","Requirement already satisfied: thinc\u003c8.4.0,\u003e=8.3.4 in /usr/local/lib/python3.12/dist-packages (from spacy) (8.3.6)\n","Requirement already satisfied: wasabi\u003c1.2.0,\u003e=0.9.1 in /usr/local/lib/python3.12/dist-packages (from spacy) (1.1.3)\n","Requirement already satisfied: srsly\u003c3.0.0,\u003e=2.4.3 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.5.1)\n","Requirement already satisfied: catalogue\u003c2.1.0,\u003e=2.0.6 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.0.10)\n","Requirement already satisfied: weasel\u003c0.5.0,\u003e=0.1.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (0.4.1)\n","Requirement already satisfied: typer\u003c1.0.0,\u003e=0.3.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (0.20.0)\n","Requirement already satisfied: numpy\u003e=1.19.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.0.2)\n","Requirement already satisfied: requests\u003c3.0.0,\u003e=2.13.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.32.4)\n","Requirement already satisfied: pydantic!=1.8,!=1.8.1,\u003c3.0.0,\u003e=1.7.4 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.11.10)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.1.6)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from spacy) (75.2.0)\n","Requirement already satisfied: packaging\u003e=20.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (25.0)\n","Requirement already satisfied: langcodes\u003c4.0.0,\u003e=3.2.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.5.0)\n","Requirement already satisfied: language-data\u003e=1.2 in /usr/local/lib/python3.12/dist-packages (from langcodes\u003c4.0.0,\u003e=3.2.0-\u003espacy) (1.3.0)\n","Requirement already satisfied: annotated-types\u003e=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,\u003c3.0.0,\u003e=1.7.4-\u003espacy) (0.7.0)\n","Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,\u003c3.0.0,\u003e=1.7.4-\u003espacy) (2.33.2)\n","Requirement already satisfied: typing-extensions\u003e=4.12.2 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,\u003c3.0.0,\u003e=1.7.4-\u003espacy) (4.15.0)\n","Requirement already satisfied: typing-inspection\u003e=0.4.0 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,\u003c3.0.0,\u003e=1.7.4-\u003espacy) (0.4.2)\n","Requirement already satisfied: charset_normalizer\u003c4,\u003e=2 in /usr/local/lib/python3.12/dist-packages (from requests\u003c3.0.0,\u003e=2.13.0-\u003espacy) (3.4.4)\n","Requirement already satisfied: idna\u003c4,\u003e=2.5 in /usr/local/lib/python3.12/dist-packages (from requests\u003c3.0.0,\u003e=2.13.0-\u003espacy) (3.11)\n","Requirement already satisfied: urllib3\u003c3,\u003e=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests\u003c3.0.0,\u003e=2.13.0-\u003espacy) (2.5.0)\n","Requirement already satisfied: certifi\u003e=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests\u003c3.0.0,\u003e=2.13.0-\u003espacy) (2025.10.5)\n","Requirement already satisfied: blis\u003c1.4.0,\u003e=1.3.0 in /usr/local/lib/python3.12/dist-packages (from thinc\u003c8.4.0,\u003e=8.3.4-\u003espacy) (1.3.0)\n","Requirement already satisfied: confection\u003c1.0.0,\u003e=0.0.1 in /usr/local/lib/python3.12/dist-packages (from thinc\u003c8.4.0,\u003e=8.3.4-\u003espacy) (0.1.5)\n","Requirement already satisfied: shellingham\u003e=1.3.0 in /usr/local/lib/python3.12/dist-packages (from typer\u003c1.0.0,\u003e=0.3.0-\u003espacy) (1.5.4)\n","Requirement already satisfied: rich\u003e=10.11.0 in /usr/local/lib/python3.12/dist-packages (from typer\u003c1.0.0,\u003e=0.3.0-\u003espacy) (13.9.4)\n","Requirement already satisfied: cloudpathlib\u003c1.0.0,\u003e=0.7.0 in /usr/local/lib/python3.12/dist-packages (from weasel\u003c0.5.0,\u003e=0.1.0-\u003espacy) (0.23.0)\n","Requirement already satisfied: smart-open\u003c8.0.0,\u003e=5.2.1 in /usr/local/lib/python3.12/dist-packages (from weasel\u003c0.5.0,\u003e=0.1.0-\u003espacy) (7.4.0)\n","Requirement already satisfied: MarkupSafe\u003e=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2-\u003espacy) (3.0.3)\n","Requirement already satisfied: marisa-trie\u003e=1.1.0 in /usr/local/lib/python3.12/dist-packages (from language-data\u003e=1.2-\u003elangcodes\u003c4.0.0,\u003e=3.2.0-\u003espacy) (1.3.1)\n","Requirement already satisfied: markdown-it-py\u003e=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich\u003e=10.11.0-\u003etyper\u003c1.0.0,\u003e=0.3.0-\u003espacy) (4.0.0)\n","Requirement already satisfied: pygments\u003c3.0.0,\u003e=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich\u003e=10.11.0-\u003etyper\u003c1.0.0,\u003e=0.3.0-\u003espacy) (2.19.2)\n","Requirement already satisfied: wrapt in /usr/local/lib/python3.12/dist-packages (from smart-open\u003c8.0.0,\u003e=5.2.1-\u003eweasel\u003c0.5.0,\u003e=0.1.0-\u003espacy) (2.0.0)\n","Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py\u003e=2.2.0-\u003erich\u003e=10.11.0-\u003etyper\u003c1.0.0,\u003e=0.3.0-\u003espacy) (0.1.2)\n"]},{"name":"stderr","output_type":"stream","text":["[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Package punkt is already up-to-date!\n","[nltk_data] Downloading package stopwords to /root/nltk_data...\n","[nltk_data]   Package stopwords is already up-to-date!\n","[nltk_data] Downloading package wordnet to /root/nltk_data...\n","[nltk_data]   Package wordnet is already up-to-date!\n","[nltk_data] Downloading package omw-1.4 to /root/nltk_data...\n","[nltk_data]   Package omw-1.4 is already up-to-date!\n"]},{"name":"stdout","output_type":"stream","text":["ðŸ¤– Customer Support Chatbot (type 'exit' to quit)\n"]}],"source":["#  Step 1: Install dependencies\n","!pip install nltk spacy\n","\n","#  Step 2: Import libraries\n","import nltk\n","import spacy\n","from nltk.corpus import stopwords\n","from nltk.stem import WordNetLemmatizer\n","import string\n","\n","# Step 3: Download required datasets\n","nltk.download('punkt')\n","nltk.download('stopwords')\n","nltk.download('wordnet')\n","nltk.download('omw-1.4')\n","\n","#  Step 4: Load spaCy model for NER\n","nlp = spacy.load(\"en_core_web_sm\")\n","\n","#  Step 5: Preprocessing function\n","def preprocess_text(text):\n","    \"\"\"Tokenize, remove punctuation/stopwords, lemmatize.\"\"\"\n","    tokens = nltk.word_tokenize(text.lower())\n","    tokens = [t for t in tokens if t not in string.punctuation]\n","    tokens = [t for t in tokens if t not in stopwords.words('english')]\n","    lemmatizer = WordNetLemmatizer()\n","    tokens = [lemmatizer.lemmatize(t) for t in tokens]\n","    return tokens\n","\n","#  Step 6: Define intents and responses\n","responses = {\n","    \"return_policy\": \"You can return products within 15 days via our online portal.\",\n","    \"order_tracking\": \"Please provide your order number to check the delivery status.\",\n","    \"delivery_time\": \"Standard delivery usually takes 3-5 business days.\",\n","    \"product_info\": \"Can you specify which product you want information about?\",\n","    \"greeting\": \"Hello! How can I assist you today?\",\n","    \"goodbye\": \"Thank you for chatting! Have a great day!\"\n","}\n","\n","#  Step 7: Intent classification (rule-based)\n","def classify_intent(user_input):\n","    user_input = user_input.lower()\n","    if \"return\" in user_input:\n","        return \"return_policy\"\n","    elif \"order\" in user_input or \"track\" in user_input:\n","        return \"order_tracking\"\n","    elif \"deliver\" in user_input or \"shipping\" in user_input:\n","        return \"delivery_time\"\n","    elif \"product\" in user_input or \"support\" in user_input or \"feature\" in user_input:\n","        return \"product_info\"\n","    elif \"hi\" in user_input or \"hello\" in user_input:\n","        return \"greeting\"\n","    elif \"bye\" in user_input or \"thank\" in user_input:\n","        return \"goodbye\"\n","    else:\n","        return \"unknown\"\n","\n","#  Step 8: Named Entity Recognition (extract order number)\n","def extract_entities(text):\n","    doc = nlp(text)\n","    entities = {}\n","    for ent in doc.ents:\n","        entities[ent.label_] = ent.text\n","    return entities\n","\n","#  Step 9: Chatbot function\n","def chatbot_response(user_input):\n","    tokens = preprocess_text(user_input)\n","    intent = classify_intent(user_input)\n","    entities = extract_entities(user_input)\n","\n","    if intent in responses:\n","        return responses[intent]\n","    else:\n","        return \"I'm sorry, I didn't understand that. Could you please rephrase?\"\n","\n","#  Step 10: Chat loop\n","print(\"ðŸ¤– Customer Support Chatbot (type 'exit' to quit)\")\n","while True:\n","    user_input = input(\"You: \")\n","    if user_input.lower() in [\"exit\", \"quit\"]:\n","        print(\"Bot: Goodbye! ðŸ‘‹\")\n","        break\n","    response = chatbot_response(user_input)\n","    print(\"Bot:\", response)\n"]}],"metadata":{"colab":{"authorship_tag":"ABX9TyM31JCLhQGN4Hnuz09wrhQC","name":"","version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}